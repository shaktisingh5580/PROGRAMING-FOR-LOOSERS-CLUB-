<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Previous Year Papers — B.Tech Collection</title>
  <meta name="description" content="Find and download B.Tech previous year papers." />
  <style>
    :root {
      --bg: #0a0a0a;
      --card: #1a1a1a;
      --border: #2a2a2a;
      --text: #ffffff;
      --text-muted: #888888;
      --text-secondary: #cccccc;
      --accent: #ffffff;
      --hover: #333333;
      --shadow: 0 4px 12px rgba(0,0,0,0.3);
      --radius: 8px;
    }

    * { box-sizing: border-box; }
    
    html, body { height: 100%; }
    
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font: 15px/1.5 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      -webkit-font-smoothing: antialiased;
    }

    /* Header */
    .header {
      background: var(--card);
      border-bottom: 1px solid var(--border);
      padding: 15px 0;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo {
      width: 40px;
      height: 40px;
      background: var(--accent);
      color: var(--bg);
      border-radius: var(--radius);
      display: grid;
      place-items: center;
      font-weight: 800;
      font-size: 16px;
    }

    .brand h1 {
      margin: 0;
      font-size: 18px;
      font-weight: 600;
    }

    .brand .subtitle {
      color: var(--text-muted);
      font-size: 13px;
      margin-top: 2px;
    }

    /* Navigation Buttons */
    .nav-buttons {
      display: flex;
      gap: 10px;
      margin-left: auto;
    }

    .nav-btn {
      padding: 8px 12px;
      background: var(--bg);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      text-decoration: none;
      font-size: 14px;
      transition: all 0.2s;
    }

    .nav-btn:hover {
      background: var(--hover);
    }

    /* Search */
    .search-wrap {
      flex: 1;
      max-width: 500px;
    }

    .search {
      position: relative;
    }

    .search input {
      width: 100%;
      padding: 12px 16px 12px 40px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      color: var(--text);
      font-size: 14px;
    }

    .search input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      width: 18px;
      height: 18px;
      color: var(--text-muted);
    }

    /* Buttons */
    .btn {
      padding: 10px 16px;
      background: var(--accent);
      color: var(--bg);
      border: none;
      border-radius: var(--radius);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn:hover {
      opacity: 0.9;
    }

    .btn.secondary {
      background: var(--card);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn.secondary:hover {
      background: var(--hover);
    }

    /* Main Content */
    .main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Collapsible Filters */
    .filters {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      margin-bottom: 30px;
      overflow: hidden;
    }

    .filters-header {
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
    }

    .filters-title {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
    }

    .filters-toggle {
      background: none;
      border: none;
      color: var(--text);
      font-size: 18px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .filters-content {
      padding: 20px;
      transition: max-height 0.3s ease;
    }

    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .filter-label {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
    }

    .filter-select {
      padding: 10px 12px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      color: var(--text);
      font-size: 14px;
    }

    .filter-select:focus {
      outline: none;
      border-color: var(--accent);
    }

    .active-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 15px;
    }

    .filter-chip {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 6px 12px;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .filter-chip button {
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      font-size: 14px;
      padding: 0;
    }

    /* Results */
    .results-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .results-count {
      color: var(--text-muted);
      font-size: 14px;
    }

    .sort-select {
      padding: 8px 12px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      color: var(--text);
      font-size: 14px;
    }

    /* Cards */
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      transition: all 0.2s;
    }

    .card:hover {
      border-color: var(--accent);
      box-shadow: var(--shadow);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }

    .card-title {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
      line-height: 1.3;
    }

    .card-badge {
      background: var(--accent);
      color: var(--bg);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .card-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 15px;
      color: var(--text-muted);
      font-size: 13px;
    }

    .card-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 15px;
      border-top: 1px solid var(--border);
    }

    .card-date {
      color: var(--text-muted);
      font-size: 12px;
    }

    .download-btn {
      padding: 8px 16px;
      background: var(--accent);
      color: var(--bg);
      text-decoration: none;
      border-radius: var(--radius);
      font-size: 13px;
      font-weight: 500;
      transition: all 0.2s;
    }

    .download-btn:hover {
      opacity: 0.9;
    }

    /* Back to Top Button */
    .back-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      background-color: #333;
      color: #fff;
      border: none;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      display: none;
      z-index: 999;
      transition: all 0.3s ease;
    }

    .back-to-top:hover {
      background-color: #555;
      transform: translateY(-2px);
    }

    .back-to-top.show {
      display: block;
    }

    /* Modal Styles for PDF Preview */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
    }

    .modal-content {
      background-color: #1a1a1a;
      margin: 2% auto;
      padding: 0;
      border: 1px solid #333;
      border-radius: 8px;
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow: hidden;
    }

    .modal-header {
      background-color: #2a2a2a;
      padding: 15px 20px;
      border-bottom: 1px solid #333;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-header h3 {
      margin: 0;
      color: #fff;
      font-size: 18px;
    }

    .modal-close {
      background: none;
      border: none;
      color: #fff;
      font-size: 24px;
      cursor: pointer;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-close:hover {
      background-color: #333;
      border-radius: 4px;
    }

    .modal-body {
      padding: 20px;
      max-height: calc(90vh - 140px);
      overflow-y: auto;
    }

    .paper-details {
      margin-bottom: 20px;
      padding: 15px;
      background-color: #2a2a2a;
      border-radius: 6px;
      border: 1px solid #333;
    }

    .paper-details .detail-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      padding: 4px 0;
    }

    .paper-details .detail-label {
      font-weight: 600;
      color: #ccc;
    }

    .paper-details .detail-value {
      color: #fff;
    }

    .pdf-preview {
      border-radius: 6px;
      overflow: hidden;
      background-color: #f0f0f0;
    }

    .modal-footer {
      background-color: #2a2a2a;
      padding: 15px 20px;
      border-top: 1px solid #333;
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header-inner {
        flex-wrap: wrap;
        gap: 15px;
      }

      .brand {
        flex: 1;
      }

      .nav-buttons {
        order: 3;
        margin-left: 0;
        width: 100%;
        justify-content: center;
      }

      .search-wrap {
        width: 100%;
        max-width: none;
        order: 2;
      }

      .main {
        padding: 15px;
      }

      /* Improved mobile filters */
      .filters-content {
        padding: 15px;
      }

      .filters-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .results-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }

      .cards {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .card {
        padding: 15px;
      }

      .card-meta {
        flex-direction: column;
        gap: 8px;
      }

      .card-footer {
        flex-direction: column;
        gap: 12px;
        align-items: flex-start;
      }

      .back-to-top {
        bottom: 15px;
        right: 15px;
        width: 45px;
        height: 45px;
      }

      .modal-content {
        width: 95%;
        margin: 5% auto;
        max-height: 85vh;
      }

      .modal-body {
        padding: 15px;
        max-height: calc(85vh - 120px);
      }

      .pdf-preview iframe {
        height: 300px;
      }

      .paper-details .detail-row {
        flex-direction: column;
        gap: 4px;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <div class="brand">
        <div class="logo">PY</div>
        <div>
          <h1>Previous Year Papers</h1>
          <div class="subtitle">B.Tech Collection</div>
        </div>
      </div>
      <div class="search-wrap">
        <div class="search">
          <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <input 
            id="searchInput" 
            type="search" 
            placeholder="Search by subject, year, or exam type..." 
            autocomplete="off"
          />
        </div>
      </div>
      <div class="nav-buttons">
        <a href="index.html" class="nav-btn">Home</a>
        <a href="chat.html" class="nav-btn">Chat</a>
        <button id="clearBtn" class="btn secondary">Clear</button>
      </div>
    </div>
  </header>

  <main class="main">
    <div class="filters">
      <div class="filters-header" onclick="toggleFilters()">
        <h2 class="filters-title">Filters</h2>
        <button class="filters-toggle" id="filtersToggle">−</button>
      </div>
      <div class="filters-content" id="filtersContent">
        <div class="filters-grid">
          <div class="filter-group">
            <label class="filter-label" for="semesterFilter">Semester</label>
            <select id="semesterFilter" class="filter-select">
              <option value="">All Semesters</option>
              <option value="1">Semester 1</option>
              <option value="2">Semester 2</option>
              <option value="3">Semester 3</option>
              <option value="4">Semester 4</option>
              <option value="5">Semester 5</option>
              <option value="6">Semester 6</option>
              <option value="7">Semester 7</option>
              <option value="8">Semester 8</option>
            </select>
          </div>

          <div class="filter-group">
            <label class="filter-label" for="examFilter">Exam Type</label>
            <select id="examFilter" class="filter-select">
              <option value="">All Exam Types</option>
              <option value="Midterm">Midterm</option>
              <option value="Final">Final</option>
              <option value="Quiz">Quiz</option>
              <option value="Assignment">Assignment</option>
            </select>
          </div>

          <div class="filter-group">
            <label class="filter-label" for="yearFilter">Year</label>
            <select id="yearFilter" class="filter-select">
              <option value="">All Years</option>
              <option value="2024">2024</option>
              <option value="2023">2023</option>
              <option value="2022">2022</option>
              <option value="2021">2021</option>
              <option value="2020">2020</option>
            </select>
          </div>

          <div class="filter-group">
            <label class="filter-label" for="subjectFilter">Subject</label>
            <select id="subjectFilter" class="filter-select">
              <option value="">All Subjects</option>
            </select>
          </div>
        </div>

        <div class="active-filters" id="activeFilters"></div>
      </div>
    </div>

    <div class="results-header">
      <div id="resultCount" class="results-count">0 papers</div>
      <div class="controls">
        <select id="sortSelect" class="sort-select">
          <option value="newest">Newest First</option>
          <option value="oldest">Oldest First</option>
          <option value="subject">By Subject</option>
          <option value="relevance">By Relevance</option>
        </select>
        <select id="pageSizeSelect" class="select">
          <option value="12">12 per page</option>
          <option value="18">18 per page</option>
          <option value="24">24 per page</option>
        </select>
      </div>
    </div>

    <div id="cardsContainer" class="cards"></div>
    <div id="pagination" class="pagination"></div>
  </main>

  <!-- Modal Dialog for PDF Preview -->
  <div id="pdfModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">Paper Details</h3>
        <button class="modal-close" onclick="closePdfModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div id="paperDetails" class="paper-details"></div>
        <div class="pdf-preview">
          <iframe id="pdfViewer" src="" width="100%" height="400px" style="border: 1px solid #333;"></iframe>
        </div>
      </div>
      <div class="modal-footer">
        <a id="downloadLink" href="#" class="download-btn" download>Download PDF</a>
        <button class="btn secondary" onclick="closePdfModal()">Close</button>
      </div>
    </div>
  </div>

  <script>
    // Load papers data
    let papersData = [];
    let filteredData = [];
    let currentPage = 1;
    let pageSize = 12;
    let currentSort = 'newest';
    let filters = {
      semester: '',
      examType: '',
      year: '',
      subject: ''
    };

    // Load JSON data
    async function loadPapersData() {
      try {
        const response = await fetch('papers-data.json');
        papersData = await response.json();
        filteredData = [...papersData];
        initializeFilters();
        renderResults();
      } catch (error) {
        console.error('Error loading papers data:', error);
        // Fallback to sample data if JSON file not found
        papersData = getSampleData();
        filteredData = [...papersData];
        initializeFilters();
        renderResults();
      }
    }

    function initializeFilters() {
      // Populate subject filter with unique subjects from data
      const subjects = [...new Set(papersData.map(paper => paper.subject))].sort();
      const subjectFilter = document.getElementById('subjectFilter');
      subjectFilter.innerHTML = '<option value="">All Subjects</option>';
      subjects.forEach(subject => {
        const option = document.createElement('option');
        option.value = subject;
        option.textContent = subject;
        subjectFilter.appendChild(option);
      });
    }

    function applyFilters() {
      filteredData = papersData.filter(paper => {
        if (filters.semester && paper.semester.toString() !== filters.semester) return false;
        if (filters.examType && paper.examType !== filters.examType) return false;
        if (filters.year && paper.year.toString() !== filters.year) return false;
        if (filters.subject && paper.subject !== filters.subject) return false;
        
        // Apply search filter
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        if (searchTerm) {
          const searchableText = `${paper.title} ${paper.subject} ${paper.examType} ${paper.tags.join(' ')}`.toLowerCase();
          if (!searchableText.includes(searchTerm)) return false;
        }
        
        return true;
      });
      
      currentPage = 1;
      renderActiveFilters();
      renderResults();
    }

    function renderActiveFilters() {
      const container = document.getElementById('activeFilters');
      const activeFilters = [];
      
      if (filters.semester) activeFilters.push({ key: 'semester', label: `Semester ${filters.semester}` });
      if (filters.examType) activeFilters.push({ key: 'examType', label: filters.examType });
      if (filters.year) activeFilters.push({ key: 'year', label: filters.year });
      if (filters.subject) activeFilters.push({ key: 'subject', label: filters.subject });
      
      container.innerHTML = activeFilters.map(filter => `
        <div class="filter-chip">
          ${filter.label}
          <button onclick="removeFilter('${filter.key}')" title="Remove filter">×</button>
        </div>
      `).join('');
    }

    function removeFilter(key) {
      filters[key] = '';
      document.getElementById(key + 'Filter').value = '';
      applyFilters();
    }

    // Sample data fallback
    function getSampleData() {
      return [
        {
          id: "1",
          title: "Data Structures and Algorithms Final Exam 2024",
          subject: "Data Structures",
          year: 2024,
          examType: "Final",
          semester: 3,
          tags: ["algorithms", "important", "with-solutions"],
          pages: 8,
          fileSizeMB: 2.1,
          fileUrl: "#"
        },
        {
          id: "2", 
          title: "Operating Systems Midterm 2024",
          subject: "Operating Systems",
          year: 2024,
          examType: "Midterm",
          semester: 4,
          tags: ["theory", "moderate"],
          pages: 6,
          fileSizeMB: 1.8,
          fileUrl: "#"
        },
        {
          id: "3",
          title: "Database Management Systems Final 2023",
          subject: "Database Systems",
          year: 2023,
          examType: "Final",
          semester: 5,
          tags: ["sql", "important", "hard"],
          pages: 10,
          fileSizeMB: 3.2,
          fileUrl: "#"
        }
      ];
    }

    // Search functionality
    function performSearch() {
      applyFilters();
    }

    // Sort functionality
    function sortPapers(sortType) {
      switch(sortType) {
        case 'newest':
          filteredData.sort((a, b) => b.year - a.year || a.subject.localeCompare(b.subject));
          break;
        case 'oldest':
          filteredData.sort((a, b) => a.year - b.year || a.subject.localeCompare(b.subject));
          break;
        case 'subject':
          filteredData.sort((a, b) => a.subject.localeCompare(b.subject) || b.year - a.year);
          break;
        case 'relevance':
          // Keep current order for relevance
          break;
      }
    }

    // Render results
    function renderResults() {
      const container = document.getElementById('cardsContainer');
      const countEl = document.getElementById('resultCount');
      
      // Update count
      countEl.textContent = `${filteredData.length} paper${filteredData.length !== 1 ? 's' : ''}`;
      
      // Sort data
      sortPapers(currentSort);
      
      // Pagination
      const totalPages = Math.ceil(filteredData.length / pageSize);
      currentPage = Math.min(currentPage, Math.max(1, totalPages));
      
      const startIndex = (currentPage - 1) * pageSize;
      const endIndex = startIndex + pageSize;
      const pageData = filteredData.slice(startIndex, endIndex);
      
      // Render cards
      if (pageData.length === 0) {
        container.innerHTML = `
          <div class="empty">
            <h3>No papers found</h3>
            <p>Try adjusting your search terms</p>
          </div>
        `;
      } else {
        container.innerHTML = pageData.map(paper => `
          <article class="card">
            <div class="card-header">
              <span class="card-badge">${paper.examType}</span>
            </div>
            <div class="card-body">
              <h3 class="card-title">${paper.title}</h3>
              <div class="card-meta">
                <span>📘 ${paper.subject}</span>
                <span>🗓️ ${paper.year}</span>
                <span>📄 ${paper.pages} pages</span>
                <span>💾 ${paper.fileSizeMB} MB</span>
              </div>
              <div class="card-tags">
                ${paper.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
              </div>
            </div>
            <div class="card-footer">
              <div class="card-date">Semester ${paper.semester}</div>
              <div class="actions">
                <button class="link" onclick="openPdfModal('${paper.id}')">View</button>
                <a href="${paper.fileUrl}" class="download-btn" download>Download</a>
              </div>
            </div>
          </article>
        `).join('');
      }
      
      // Render pagination
      renderPagination(totalPages);
    }

    // Render pagination
    function renderPagination(totalPages) {
      const container = document.getElementById('pagination');
      
      if (totalPages <= 1) {
        container.innerHTML = '';
        return;
      }
      
      let html = '';
      
      // Previous button
      html += `<button class="page-btn" ${currentPage === 1 ? 'disabled' : ''} onclick="changePage(${currentPage - 1})">Previous</button>`;
      
      // Page numbers
      for (let i = 1; i <= totalPages; i++) {
        if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
          html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
        } else if (i === currentPage - 2 || i === currentPage + 2) {
          html += '<span class="page-btn" style="border:none;background:transparent">...</span>';
        }
      }
      
      // Next button
      html += `<button class="page-btn" ${currentPage === totalPages ? 'disabled' : ''} onclick="changePage(${currentPage + 1})">Next</button>`;
      
      container.innerHTML = html;
    }

    // Change page
    function changePage(page) {
      currentPage = page;
      renderResults();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Clear all filters and search
    function clearAll() {
      document.getElementById('searchInput').value = '';
      filters = { semester: '', examType: '', year: '', subject: '' };
      document.getElementById('semesterFilter').value = '';
      document.getElementById('examFilter').value = '';
      document.getElementById('yearFilter').value = '';
      document.getElementById('subjectFilter').value = '';
      
      filteredData = [...papersData];
      currentPage = 1;
      renderActiveFilters();
      renderResults();
    }

    // Toggle filters on mobile
    function toggleFilters() {
      const content = document.getElementById('filtersContent');
      const toggle = document.getElementById('filtersToggle');
      const isCollapsed = content.style.maxHeight === '0px' || content.style.maxHeight === '';
      
      if (isCollapsed) {
        content.style.maxHeight = content.scrollHeight + 'px';
        toggle.textContent = '−';
      } else {
        content.style.maxHeight = '0px';
        toggle.textContent = '+';
      }
    }

    // Scroll to top functionality
    function scrollToTop() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }

    // Show/hide back to top button
    window.addEventListener('scroll', function() {
      const backToTop = document.getElementById('backToTop');
      if (window.pageYOffset > 300) {
        backToTop.classList.add('show');
      } else {
        backToTop.classList.remove('show');
      }
    });

    // Initialize filters as collapsed on mobile
    if (window.innerWidth <= 768) {
      const content = document.getElementById('filtersContent');
      const toggle = document.getElementById('filtersToggle');
      content.style.maxHeight = '0px';
      toggle.textContent = '+';
    }

    // PDF modal functions
    function openPdfModal(paperId) {
      const paper = papersData.find(p => p.id === paperId);
      if (!paper) return;

      document.getElementById('modalTitle').textContent = paper.title;
      
      // Populate paper details
      const detailsHtml = `
        <div class="detail-row">
          <span class="detail-label">Subject:</span>
          <span class="detail-value">${paper.subject}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Year:</span>
          <span class="detail-value">${paper.year}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Exam Type:</span>
          <span class="detail-value">${paper.examType}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Semester:</span>
          <span class="detail-value">${paper.semester}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Pages:</span>
          <span class="detail-value">${paper.pages}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">File Size:</span>
          <span class="detail-value">${paper.fileSizeMB} MB</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Tags:</span>
          <span class="detail-value">${paper.tags.join(', ')}</span>
        </div>
      `;
      
      document.getElementById('paperDetails').innerHTML = detailsHtml;
      
      // Set PDF viewer source (for demo purposes, using a placeholder)
      const pdfViewer = document.getElementById('pdfViewer');
      if (paper.fileUrl && paper.fileUrl !== '#') {
        pdfViewer.src = paper.fileUrl;
      } else {
        // Placeholder PDF viewer
        pdfViewer.src = 'data:text/html,<html><body style="margin:0;padding:20px;font-family:Arial;background:#f5f5f5;"><h3>PDF Preview</h3><p>This is a preview of: <strong>' + paper.title + '</strong></p><p>In a real implementation, this would show the actual PDF content.</p><p>File: ' + paper.fileSizeMB + ' MB, ' + paper.pages + ' pages</p></body></html>';
      }
      
      document.getElementById('downloadLink').href = paper.fileUrl;
      document.getElementById('pdfModal').style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    function closePdfModal() {
      document.getElementById('pdfModal').style.display = 'none';
      document.body.style.overflow = 'auto';
      document.getElementById('pdfViewer').src = '';
    }

    // Modal close on outside click
    window.addEventListener('click', function(event) {
      const modal = document.getElementById('pdfModal');
      if (event.target === modal) {
        closePdfModal();
      }
    });

    // Keyboard support for modal
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        const modal = document.getElementById('pdfModal');
        if (modal.style.display === 'block') {
          closePdfModal();
        }
      }
    });

    // Event listeners
    document.addEventListener('DOMContentLoaded', function() {
      loadPapersData();
      
      // Search input
      const searchInput = document.getElementById('searchInput');
      searchInput.addEventListener('input', debounce(performSearch, 300));
      
      document.getElementById('semesterFilter').addEventListener('change', function() {
        filters.semester = this.value;
        applyFilters();
      });
      
      document.getElementById('examFilter').addEventListener('change', function() {
        filters.examType = this.value;
        applyFilters();
      });
      
      document.getElementById('yearFilter').addEventListener('change', function() {
        filters.year = this.value;
        applyFilters();
      });
      
      document.getElementById('subjectFilter').addEventListener('change', function() {
        filters.subject = this.value;
        applyFilters();
      });
      
      // Clear button
      document.getElementById('clearBtn').addEventListener('click', clearAll);
    });

    // Debounce function for search input
    function debounce(func, wait) {
      let timeout;
      return function(...args) {
        const context = this;
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(context, args), wait);
      };
    }
  </script>
</body>
</html>
